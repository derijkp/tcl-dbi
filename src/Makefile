# Generated automatically from Makefile.in by configure.
#
# This file is a Makefile.  If it has the name "Makefile.in"
# then it is a template for a Makefile;  to generate the actual Makefile,
# run "./configure", which is a configuration script generated by the
# "autoconf" program (constructs like "@foo@" will get replaced in the
# actual Makefile.
#

# set to yes to compile with debugging information
DEBUG=yes
# set to no to compile without stubs support
USE_STUBS=no

#----------------------------------------------------------------
# The information below is modified by the configure script when
# Makefile is generated from Makefile.in.  You shouldn't normally
# modify any of this stuff by hand.
#----------------------------------------------------------------

PROJECT = dbi
TCLEXE = dbitcl
POSTGRESQLOBJS =  postgresql.o
POSTGRESQLSRCS = postgresql.c
POSTGRESQLLIBS = -lpq
ODBCOBJS =  odbc.o odbc_result.o
ODBCSRCS = odbc.c odbc_result.c
ODBCLIBS = -lodbc
OBJECTS = dbiInit.o dbi.o $(POSTGRESQLOBJS) $(ODBCOBJS)
SRCS = dbiInit.c dbi.c $(POSTGRESQLSRC) $(ODBCSRCS)

ifeq ($(DEBUG),yes)
	CFLAGS = -g  
else
	CFLAGS = -O 
endif

ifeq ($(USE_STUBS),yes)
	LD_LIBS = $(POSTGRESQLLIBS) $(ODBCLIBS)  
	DEFS =  -DHAVE_GETCWD=1 -DHAVE_UNISTD_H=1 -DHAVE_SYS_TIME_H=1 -DTIME_WITH_SYS_TIME=1 -DHAVE_TM_ZONE=1 -DHAVE_TM_GMTOFF=1 -DHAVE_TIMEZONE_VAR=1 -DHAVE_ST_BLKSIZE=1 -DSTDC_HEADERS=1 -DNEED_MATHERR=1 -DRETSIGTYPE=void -DHAVE_SIGNED_CHAR=1 -DHAVE_SYS_IOCTL_H=1  -DUSE_TCL_STUBS
else
	LD_LIBS = $(POSTGRESQLLIBS) $(ODBCLIBS) -L/usr/lib -ltcl8.0${TCL_DBGX}  -ldl  -lm
	DEFS =  -DHAVE_GETCWD=1 -DHAVE_UNISTD_H=1 -DHAVE_SYS_TIME_H=1 -DTIME_WITH_SYS_TIME=1 -DHAVE_TM_ZONE=1 -DHAVE_TM_GMTOFF=1 -DHAVE_TIMEZONE_VAR=1 -DHAVE_ST_BLKSIZE=1 -DSTDC_HEADERS=1 -DNEED_MATHERR=1 -DRETSIGTYPE=void -DHAVE_SIGNED_CHAR=1 -DHAVE_SYS_IOCTL_H=1 
endif

INCLUDES = -I/usr/include
CC = gcc
SHLIB_LD =		gcc -shared
SHLIB_SUFFIX =		.so

CC_SWITCHES =  -I../extern $(INCLUDES) $(CFLAGS)	-fPIC $(DEFS)

# --------------------------- Rules -----------------------------

all: depend $(PROJECT)$(SHLIB_SUFFIX)

$(PROJECT)${SHLIB_SUFFIX}: $(OBJECTS)
	${SHLIB_LD} $(OBJECTS) -o ../$(PROJECT)$(SHLIB_SUFFIX) $(LD_LIBS)

$(TCLEXE): tclAppInit.o $(OBJECTS)
	${CC} tclAppInit.o $(OBJECTS) -o $(TCLEXE) $(LD_LIBS)

test:
	cd ../tests ; ./all.tcl

install: 
	../makedist.tcl /usr/lib /usr/bin

clean:
	rm -f ../$(PROJECT)$(SHLIB_SUFFIX) $(TCLEXE) $(WISHEXE) *.o
	rm -rf win/*.csm ../*.dll ./*.dll win/tmp/*
	rm -f core ../core ../tests/core

distclean:
	rm -f config.cache config.log config.status Makefile

depend:
	makedepend -- $(CC_SWITCHES) -- $(SRCS)

.c.o:
	$(CC) -c $(CC_SWITCHES) $<

# DO NOT DELETE THIS LINE -- make depend depends on it.
